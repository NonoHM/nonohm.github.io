<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> THM Windows Forensics 2 | NonoHM </title> <meta name="author" content="NonoHM "> <meta name="description" content="Welcome to my personnal website. I am currently a 2nd year student in the " but r et t program. i like doing sports and music besides learning new things in it.> <meta name="keywords" content="jekyll, jekyll-theme, portfolio-website, writeups, projects"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link defer href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://nonohm.github.io/blog/2025/THM-Windows-Forensics-2/"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> NonoHM </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">THM Windows Forensics 2</h1> <p class="post-meta"> January 19, 2025 • NonoHM </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/thm"> <i class="fa-solid fa-hashtag fa-sm"></i> THM</a>   <a href="/blog/tag/digital-forensics"> <i class="fa-solid fa-hashtag fa-sm"></i> Digital Forensics</a>   <a href="/blog/tag/incident-response"> <i class="fa-solid fa-hashtag fa-sm"></i> Incident Response</a>   <a href="/blog/tag/windows"> <i class="fa-solid fa-hashtag fa-sm"></i> Windows</a>   <a href="/blog/tag/windows-forensics"> <i class="fa-solid fa-hashtag fa-sm"></i> Windows Forensics</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <h2 id="task-1---introduction">Task 1 - Introduction</h2> <p>In the previous <a href="https://tryhackme.com/room/windowsforensics1" rel="external nofollow noopener" target="_blank">Windows Forensics</a> room, we learned about gathering forensics artifacts such as System Information, User Information, Files and Folders Accessed, Executed Programs and External devices connected to the system, all that from the Windows Registry.</p> <p>However, the Windows Registry isn’t the only place where forensic artifacts can be found. In this room, we’ll dive into other important locations to uncover forensic evidence. Here’s what we’ll cover:</p> <ul> <li> <strong>Windows File Systems</strong>: A look at the file systems commonly used by Windows and where to find important artifacts.</li> <li> <strong>Finding Artifacts</strong>: How to locate evidence that shows program execution, file or folder usage, user knowledge, or external device activity.</li> <li> <strong>Recovering Deleted Files</strong>: The basics of bringing back deleted files and understanding their significance in investigations.</li> </ul> <p>We will use tools from <a href="https://ericzimmerman.github.io/#!index.md" rel="external nofollow noopener" target="_blank">Eric Zimmerman’s suite</a> to analyze these artifacts. For certain tasks, we’ll also use Autopsy, a handy digital forensics platform.</p> <h2 id="task-2---the-fat-filesystems">Task 2 - The FAT Filesystems</h2> <p>To start with, a file system is a <strong>standard way to organize bits</strong> stored on a storage device such as a USB flash drive, to make bits interpreted easily.</p> <p>The File Allocation Table (FAT) file system has been the default for Microsoft OSes until Windows XP. The file system creates an <strong>index table</strong> statically allocated at the formatting time, which is stored on the device to <strong>identify clusters</strong>.</p> <figure> <picture> <img src="/assets/img/images/2025-01-19-thm-windows-forensics-2/H1-TRQnLkg.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="FAT12 file system Disk Organisation" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Clusters are <strong>small chunks of bits</strong>, small data regions on a disk and <strong>each file on a disk is a group of clusters</strong>. <strong>Each cluster value</strong> in the FAT table <strong>points to another cluster</strong> to identify each file’s continuity. Moreover, a <strong>root directory</strong> , which is also another table type, contains file identifiation information like filename, starting cluster, and filename length like presented below :</p> <figure> <picture> <img src="/assets/img/images/2025-01-19-thm-windows-forensics-2/rktZRQ3Ikx.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="FAT Table and Root Directory" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p><em>Diagrams from <a href="https://www.sqlpassion.at/archive/2022/03/03/reading-files-from-a-fat12-partition/" rel="external nofollow noopener" target="_blank">sqlpassion.at</a></em></p> <h3 id="fat12-fat16-and-fat32">FAT12, FAT16, and FAT32</h3> <p>Because the FAT file format divides the available disk space into clusters, the number of these depends on the <strong>number of bits used</strong> to address the cluster. Hence the different variations of the FAT file system. FAT was originally developped with 8-bit cluster addressing, and later as storage increased, FAT12, FAT16 and FAT32 were introduced.</p> <p>The following table summarizes the different FAT attributes :</p> <table> <thead> <tr> <th><strong>Attribute</strong></th> <th><strong>FAT12</strong></th> <th><strong>FAT16</strong></th> <th><strong>FAT32</strong></th> </tr> </thead> <tbody> <tr> <td>Addressable bits</td> <td>12</td> <td>16</td> <td>28</td> </tr> <tr> <td>Max number of clusters</td> <td>4,096</td> <td>65,536</td> <td>268,435,456</td> </tr> <tr> <td>Supported size of clusters</td> <td>512B - 8KB</td> <td>2KB - 32KB</td> <td>4KB - 32KB</td> </tr> <tr> <td>Maximum Volume size</td> <td>32MB</td> <td>2GB</td> <td>2TB</td> </tr> </tbody> </table> <p>Even though the maximum volume size for FAT32 is 2TB, Windows limits formatting to only 32GB (for reliability, since FAT32 scales horribly). However, volume sizes formatted on other OS with larger volume sizes are supported by Windows.</p> <p>The chances of coming across a FAT12 filesystem are very rare nowadays. FAT16 and FAT32 are still used in some places. However, the maximum volume size and the maximum file size (4GB - 1 file size for both FAT16 and FAT32) are limiting factors that have reduced their usage.</p> <h3 id="the-exfat-file-system">The exFAT file system</h3> <p>As file sizes have grown, the maximum file size limit of FAT32 became a real limiting factor, especially for cameras. Hence, for this reason the exFAT file system was created.</p> <p>The exFAT file system is now the default for SD Cards larger than 32 GB. It has also been adopted widely by most manufacturers of digital devices. The exFAT file system supports a cluster size of 4KB to 32MB. It has a maximum file size and a maximum volume size of 128PB (Petabytes). It also reduces some of the overheads of the FAT file system to make it lighter and more efficient. It can have a maximum of 2,796,202 files per directory.</p> <h3 id="questions">Questions</h3> <p><strong>How many addressable bits are there in the FAT32 file system?</strong></p> <p><em>Answer : <code class="language-plaintext highlighter-rouge">28 bits</code></em></p> <p><strong>What is the maximum file size supported by the FAT32 file system?</strong></p> <p><em>Answer : <code class="language-plaintext highlighter-rouge">4GB</code></em></p> <p><strong>Which file system is used by digital cameras and SD cards?</strong></p> <p><em>Answer : <code class="language-plaintext highlighter-rouge">exFAT</code></em></p> <h2 id="task----the-ntfs-file-system">Task - The NTFS File System</h2> <p>As observed previously, FAT is a very basic file system. For the need of <strong>security, reliability, recovery, file and volume sizes capabilities</strong>, Microsoft have developed a newer file system caled the New Technology File System (NTFS). It was introduced in 1993 with Windows NT 3.1 but became mainstream since Windows XP.</p> <h3 id="ntfs-features">NTFS Features</h3> <p>The NTFS file system introduces a lot of new features. As we discuss below, these are :</p> <ul> <li> <strong>Journaling</strong> : It <strong>keeps a log of changes</strong> to the metadata in the volumes to help the system recover from a crash or data movement due to defragmentation. This log is stored in <em>$LOGFILE</em> in the volume’s <em>root directory</em>.</li> <li> <strong>Access Controls</strong> : It <strong>defines the owner</strong> of a file/directory and permissions for each user.</li> <li> <strong>Volume Shadow Copy</strong> : It <strong>keeps track of changes</strong> made to a file using <em>Shadow Copies</em>. Using this feature, a user can <strong>restore previous file versions</strong> for recovery or system restore. In recent ransomware attacks, ransomware actores have been noted to delete the shadow copies on a victim’s file systems to prevent them from data recovering.</li> <li> <strong>Alternate Data Streams</strong> : A data stream refers to a sequence of data associated with a file. Files contains a Default data stream, which stores the actual content of the file but NTFS allow for an Alternate Data Stream, which helps to <strong>store additionnal metadata</strong> for like identifying the file’s origin. Malware has also been observed to hide their code in ADS.</li> <li> <strong>Master File Table</strong> : Like the File Allocation Table, there is a Master File Table in NTFS. Howerver MFT is much more extensive and is a <strong>structured database</strong> that <strong>tracks the objects stored in the volume</strong>. From a foresics point of view the following are some of the critical files in the MFT. <ul> <li> <strong>$MFT</strong> : It is the <strong>first record</strong> in the volume. The Volume Boot Record (VBR) points to where it is located. $MFT stores information about the clusters where all other objects present on the volume are located. This file contains a directory of all the files present on the volume.</li> <li> <strong>$LOGFILE</strong> : It stores the <strong>transactional logging</strong> of the file system. Thus, it helps maintaining the file system integrity.</li> <li> <strong>$UsnJrnl</strong> : It stands for Update Sequence Number (USN) Journal. It is present in the <em>$Extend</em> record. It contains information about all the <strong>files that were changed</strong> in the file system and the <strong>reason</strong> for it. It is also called the change journal.</li> </ul> </li> </ul> <h3 id="mft-explorer">MFT Explorer</h3> <p>To continue with, MFT Explorer is one of the Eric Zimmerman’s tools used to explorer MFT files. It is available both in CLI and GUI.</p> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">user</span><span class="err">@</span><span class="nx">machine</span><span class="err">$</span><span class="w"> </span><span class="nx">MFTECmd.exe</span><span class="w">

</span><span class="n">MFTECmd</span><span class="w"> </span><span class="nx">version</span><span class="w"> </span><span class="nx">0.5.0.1</span><span class="w">

</span><span class="n">Author:</span><span class="w"> </span><span class="nx">Eric</span><span class="w"> </span><span class="nx">Zimmerman</span><span class="w"> </span><span class="p">(</span><span class="n">saericzimmerman</span><span class="err">@</span><span class="nx">gmail.com</span><span class="p">)</span><span class="w">
</span><span class="n">https://github.com/EricZimmerman/MFTECmd</span><span class="w">

        </span><span class="n">f</span><span class="w">               </span><span class="nx">File</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">process</span><span class="w"> </span><span class="p">(</span><span class="nv">$MFT</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nv">$J</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nv">$LogFile</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nv">$Boot</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nv">$SDS</span><span class="p">)</span><span class="o">.</span><span class="w"> </span><span class="n">Required</span><span class="w">
        </span><span class="nx">m</span><span class="w">               </span><span class="nv">$MFT</span><span class="w"> </span><span class="nx">file</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">use</span><span class="w"> </span><span class="nx">when</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="nx">points</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nv">$J</span><span class="w"> </span><span class="nx">file</span><span class="w"> </span><span class="p">(</span><span class="n">Use</span><span class="w"> </span><span class="nx">this</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">resolve</span><span class="w"> </span><span class="nx">parent</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="nv">$J</span><span class="w"> </span><span class="nx">CSV</span><span class="w"> </span><span class="nx">output</span><span class="p">)</span><span class="o">.</span><span class="w">
  
  </span><span class="n">json</span><span class="w">            </span><span class="nx">Directory</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">save</span><span class="w"> </span><span class="nx">JSON</span><span class="w"> </span><span class="nx">formatted</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="nx">to.</span><span class="w"> </span><span class="nx">This</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nt">--csv</span><span class="w"> </span><span class="nx">required</span><span class="w"> </span><span class="nx">unless</span><span class="w"> </span><span class="nt">--de</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nt">--body</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">specified</span><span class="w">
        </span><span class="n">jsonf</span><span class="w">           </span><span class="nx">File</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">save</span><span class="w"> </span><span class="nx">JSON</span><span class="w"> </span><span class="nx">formatted</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="nx">to.</span><span class="w"> </span><span class="nx">When</span><span class="w"> </span><span class="nx">present</span><span class="p">,</span><span class="w"> </span><span class="nx">overrides</span><span class="w"> </span><span class="nx">default</span><span class="w"> </span><span class="nx">name</span><span class="w">
        </span><span class="n">csv</span><span class="w">             </span><span class="nx">Directory</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">save</span><span class="w"> </span><span class="nx">CSV</span><span class="w"> </span><span class="nx">formatted</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="nx">to.</span><span class="w"> </span><span class="nx">This</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nt">--json</span><span class="w"> </span><span class="nx">required</span><span class="w"> </span><span class="nx">unless</span><span class="w"> </span><span class="nt">--de</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nt">--body</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">specified</span><span class="w">
        </span><span class="n">csvf</span><span class="w">            </span><span class="nx">File</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">save</span><span class="w"> </span><span class="nx">CSV</span><span class="w"> </span><span class="nx">formatted</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="nx">to.</span><span class="w"> </span><span class="nx">When</span><span class="w"> </span><span class="nx">present</span><span class="p">,</span><span class="w"> </span><span class="nx">overrides</span><span class="w"> </span><span class="nx">default</span><span class="w"> </span><span class="nx">name</span><span class="w">
</span><span class="o">...</span><span class="w">
</span></code></pre></div></div> <p>Furthermore, <em>MFTECmd</em> parses data from files created by the NTFS file system ($MFT, $Boot…). Then, we can use EZviewer to view the output of this tool.</p> <h3 id="questions-1">Questions</h3> <p><strong>Parse the $MFT file placed in <code class="language-plaintext highlighter-rouge">C:\users\THM-4n6\Desktop\triage\C\</code> and analyze it. What is the Size of the file located at .<code class="language-plaintext highlighter-rouge">\Windows\Security\logs\SceSetupLog.etl</code></strong></p> <p>After using the command <code class="language-plaintext highlighter-rouge">.\MFTECmd.exe -f 'C:\Users\THM-4n6\Desktop\triage\C\$MFT' --csv ./</code>, we open the csv file in EZViewer and we search for the name <code class="language-plaintext highlighter-rouge">SceSetupLog.etl</code>. Then, we get the file size at the 9th column.</p> <figure> <picture> <img src="/assets/img/images/2025-01-19-thm-windows-forensics-2/SykSvK68ke.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="EZViewer \$MFT parsed" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p><em>Answer : <code class="language-plaintext highlighter-rouge">49152</code></em></p> <p><strong>What is the size of the cluster for the volume from which this triage was taken?</strong></p> <p>The cluster size is available in the <code class="language-plaintext highlighter-rouge">$Boot</code> file. After parsing it and viewing it with EZViewer, we get the answer in the <em>ClusterSize</em> column.</p> <figure> <picture> <img src="/assets/img/images/2025-01-19-thm-windows-forensics-2/ByD1YFp8kl.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="EZViewer \$Boot parsed" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p><em>Answer : <code class="language-plaintext highlighter-rouge">4096</code></em></p> <h2 id="task-4---recovering-deleted-files">Task 4 - Recovering Deleted Files</h2> <p>Understanding the file systems makes it easier to know how files are deleted, recovered and wiped. As we learned, a file system stores the location of a file in a <strong>table or a database</strong>. When a file is deleted, the file system <strong>remove the entry</strong> that store the file’s location on disk. This means the location where the file existed is now <strong>available for writing</strong>. However, the file contents is <strong>still there</strong> as long as they are not overwritten by the file system while copying another file or by the disk firmware while performing .</p> <p>In order to recover the data on a disk, we can either choose to understand the file strucutre of different file types to identify the specific file through an hex editor, or either choose to use a tool like autopsy to make the work for us on a disk image.</p> <h3 id="disk-image">Disk Image</h3> <p>A disk image is a file that contains a <strong>bit-by-bit copy</strong> of a disk drive, including all the file system’s metadata, in a single file. Thus, while performing forensics, making several copies of a physical evidence is very useful :</p> <ol> <li>The original evidence is <strong>not contaminated</strong> </li> <li>The disk image file can be copied and analyzed <strong>without using any specialized hardware</strong>.</li> </ol> <h3 id="recovering-files-using-autopsy">Recovering files using Autopsy</h3> <p>On the case of recovering files, we will use <em>Autopsy</em>. For a deeper walkthrough, a dedicated room is available <a href="https://tryhackme.com/room/btautopsye0" rel="external nofollow noopener" target="_blank">here</a>.</p> <p>When opening Autopsy, we are greeted with the following screen :</p> <figure> <picture> <img src="/assets/img/images/2025-01-19-thm-windows-forensics-2/Hy4i0cT8kx.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Autopsy Welcome Menu" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Then, we need to click on the <em>New Case</em> option and follow the instructions below.</p> <ol> <li> <strong>Fill the case information</strong>. Here, we can add a name, choose the directory and use the <em>Single-User</em> case type.</li> <li> <strong>Fill the optional case information number</strong>. Here, we don’t need to specify any of the text boxes.</li> <li> <strong>Choose a data source</strong>. Here, we need to investigate a disk image so we choose the first option and we choose <em>Disk Image or VM File</em>. Then we need to provide the disk image’s location.</li> <li> <strong>Configure ingest</strong>. Here, we don’t need to run the different modules like <em>Recent Activity</em>, <em>Hash lookup</em>…</li> </ol> <p>After that Autopsy has processed the image, we get the following screen when we click on the <em>usb.001</em> device :</p> <figure> <picture> <img src="/assets/img/images/2025-01-19-thm-windows-forensics-2/SJyS-jp81l.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Autopsy File Listing" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>We notice that deleted files are marked with a cross, like <code class="language-plaintext highlighter-rouge">New Microsoft Excel Worksheet.xlsx~RFcd07702.TMP</code> on the screenshot above. To recover a deleted file, we must right-click on it and select the <em>Extract File(s)</em> option.</p> <figure> <picture> <img src="/assets/img/images/2025-01-19-thm-windows-forensics-2/SkcdXopI1g.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Autopsy Extract File(s)" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Then, we are prompted where to save the requested file.</p> <h3 id="questions-2">Questions</h3> <p><strong>There is another xlsx file that was deleted. What is the full name of that file?</strong></p> <p>On the right side of Autopsy’s window, there are two more shown deleted file.</p> <figure> <picture> <img src="/assets/img/images/2025-01-19-thm-windows-forensics-2/ByWP4opU1e.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Autopsy Deleted Files" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p><em>Answer : <code class="language-plaintext highlighter-rouge">Tryhackme.xlsx</code></em></p> <p><strong>What is the name of the TXT file that was deleted from the disk?</strong></p> <p><em>Answer : <code class="language-plaintext highlighter-rouge">TryHackMe2.txt</code></em></p> <p><strong>Recover the TXT file from Question #2. What was written in this txt file?</strong></p> <p><em>Answer : <code class="language-plaintext highlighter-rouge">THM-4n6-2-4</code></em></p> <h2 id="task-5---evidence-of-execution">Task 5 - Evidence of Execution</h2> <h3 id="windows-prefetch-files">Windows Prefetch Files</h3> <p>To continue with, Windows stores <strong>information about ran program</strong> for future use, in order to <strong>quickly load programs</strong> in case of frequent use. This information is stored in prefetch files which are located in the <code class="language-plaintext highlighter-rouge">C:\Windows\Prefetch</code> directory.</p> <p>Prefetch files use the <code class="language-plaintext highlighter-rouge">.pf</code> extension and contains the following information :</p> <ul> <li><strong>Last times the program was ran</strong></li> <li><strong>Number of times the application was ran</strong></li> <li><strong>Any files and device handles used by the file</strong></li> </ul> <p>Hence, it forms an excellent source of information about the last executed programs and files. For parsing <code class="language-plaintext highlighter-rouge">.pf</code> files, we can use <em>Prefetch Parser</em> (PECmd.exe) from Eric Zimmerman.</p> <p>To run Prefetch Parser, here are some usage examples :</p> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">user</span><span class="err">@</span><span class="nx">machine</span><span class="err">$</span><span class="w"> </span><span class="nx">PECmd.exe</span><span class="w">

</span><span class="n">PECmd</span><span class="w"> </span><span class="nx">version</span><span class="w"> </span><span class="nx">1.4.0.0</span><span class="w">

</span><span class="n">Author:</span><span class="w"> </span><span class="nx">Eric</span><span class="w"> </span><span class="nx">Zimmerman</span><span class="w"> </span><span class="p">(</span><span class="n">saericzimmerman</span><span class="err">@</span><span class="nx">gmail.com</span><span class="p">)</span><span class="w">
</span><span class="n">https://github.com/EricZimmerman/PECmd</span><span class="w">

        </span><span class="n">d</span><span class="w">               </span><span class="nx">Directory</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">recursively</span><span class="w"> </span><span class="nx">process.</span><span class="w"> </span><span class="nx">Either</span><span class="w"> </span><span class="nx">this</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">required</span><span class="w">
        </span><span class="n">f</span><span class="w">               </span><span class="nx">File</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">process.</span><span class="w"> </span><span class="nx">Either</span><span class="w"> </span><span class="nx">this</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nt">-d</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">required</span><span class="w">
        </span><span class="n">k</span><span class="w">               </span><span class="nx">Comma</span><span class="w"> </span><span class="nx">separated</span><span class="w"> </span><span class="nx">list</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">keywords</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">highlight</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="nx">output.</span><span class="w"> </span><span class="nx">By</span><span class="w"> </span><span class="nx">default</span><span class="p">,</span><span class="w"> </span><span class="s1">'temp'</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="s1">'tmp'</span><span class="w"> </span><span class="nx">are</span><span class="w"> </span><span class="nx">highlighted.</span><span class="w"> </span><span class="nx">Any</span><span class="w"> </span><span class="nx">additional</span><span class="w"> </span><span class="nx">keywords</span><span class="w"> </span><span class="nx">will</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">added</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">these.</span><span class="w">
        </span><span class="n">o</span><span class="w">               </span><span class="nx">When</span><span class="w"> </span><span class="nx">specified</span><span class="p">,</span><span class="w"> </span><span class="nx">save</span><span class="w"> </span><span class="nx">prefetch</span><span class="w"> </span><span class="nx">file</span><span class="w"> </span><span class="nx">bytes</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">given</span><span class="w"> </span><span class="nx">path.</span><span class="w"> </span><span class="nx">Useful</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">look</span><span class="w"> </span><span class="nx">at</span><span class="w"> </span><span class="nx">decompressed</span><span class="w"> </span><span class="nx">Win10</span><span class="w"> </span><span class="nx">files</span><span class="w">
        </span><span class="n">q</span><span class="w">               </span><span class="nx">Do</span><span class="w"> </span><span class="nx">not</span><span class="w"> </span><span class="nx">dump</span><span class="w"> </span><span class="nx">full</span><span class="w"> </span><span class="nx">details</span><span class="w"> </span><span class="nx">about</span><span class="w"> </span><span class="nx">each</span><span class="w"> </span><span class="nx">file</span><span class="w"> </span><span class="nx">processed.</span><span class="w"> </span><span class="nx">Speeds</span><span class="w"> </span><span class="nx">up</span><span class="w"> </span><span class="nx">processing</span><span class="w"> </span><span class="nx">when</span><span class="w"> </span><span class="nx">using</span><span class="w"> </span><span class="nt">--json</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nt">--csv</span><span class="o">.</span><span class="w"> </span><span class="nx">Default</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">FALSE</span><span class="w">

        </span><span class="n">json</span><span class="w">            </span><span class="nx">Directory</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">save</span><span class="w"> </span><span class="nx">json</span><span class="w"> </span><span class="nx">representation</span><span class="w"> </span><span class="nx">to.</span><span class="w">
        </span><span class="n">jsonf</span><span class="w">           </span><span class="nx">File</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">save</span><span class="w"> </span><span class="nx">JSON</span><span class="w"> </span><span class="nx">formatted</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="nx">to.</span><span class="w"> </span><span class="nx">When</span><span class="w"> </span><span class="nx">present</span><span class="p">,</span><span class="w"> </span><span class="nx">overrides</span><span class="w"> </span><span class="nx">default</span><span class="w"> </span><span class="nx">name</span><span class="w">
        </span><span class="n">csv</span><span class="w">             </span><span class="nx">Directory</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">save</span><span class="w"> </span><span class="nx">CSV</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="nx">to.</span><span class="w"> </span><span class="nx">Be</span><span class="w"> </span><span class="nx">sure</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">include</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">full</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="nx">double</span><span class="w"> </span><span class="nx">quotes</span><span class="w">
        </span><span class="n">csvf</span><span class="w">            </span><span class="nx">File</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">save</span><span class="w"> </span><span class="nx">CSV</span><span class="w"> </span><span class="nx">formatted</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="nx">to.</span><span class="w"> </span><span class="nx">When</span><span class="w"> </span><span class="nx">present</span><span class="p">,</span><span class="w"> </span><span class="nx">overrides</span><span class="w"> </span><span class="nx">default</span><span class="w"> </span><span class="nx">name</span><span class="w">
</span><span class="o">...</span><span class="w">

</span><span class="n">Examples:</span><span class="w"> </span><span class="nx">PECmd.exe</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">path-to-Prefetch-files</span><span class="err">&gt;</span><span class="w"> </span><span class="nt">--csv</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">path-to-save-csv</span><span class="err">&gt;</span><span class="w">
          </span><span class="n">PECmd.exe</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="s2">"C:\Temp\CALC.EXE-3FBEF7FD.pf"</span><span class="w">
          </span><span class="n">PECmd.exe</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="s2">"C:\Temp\CALC.EXE-3FBEF7FD.pf"</span><span class="w"> </span><span class="nt">--json</span><span class="w"> </span><span class="s2">"D:\jsonOutput"</span><span class="w"> </span><span class="nt">--jsonpretty</span><span class="w">
          </span><span class="n">PECmd.exe</span><span class="w"> </span><span class="nt">-d</span><span class="w"> </span><span class="s2">"C:\Temp"</span><span class="w"> </span><span class="nt">-k</span><span class="w"> </span><span class="s2">"system32, fonts"</span><span class="w">
          </span><span class="n">PECmd.exe</span><span class="w"> </span><span class="nt">-d</span><span class="w"> </span><span class="s2">"C:\Temp"</span><span class="w"> </span><span class="nt">--csv</span><span class="w"> </span><span class="s2">"c:\temp"</span><span class="w"> </span><span class="nt">--csvf</span><span class="w"> </span><span class="nx">foo.csv</span><span class="w"> </span><span class="nt">--json</span><span class="w"> </span><span class="nx">c:\temp\json</span><span class="w">
          </span><span class="n">PECmd.exe</span><span class="w"> </span><span class="nt">-d</span><span class="w"> </span><span class="s2">"C:\Windows\Prefetch"</span><span class="w">
</span></code></pre></div></div> <h3 id="windows-10-timeline">Windows 10 Timeline</h3> <p>In addition to, Windows 10 stored <strong>recently used applications and files</strong> in an SQLite database called <em>Windows 10 Timeline</em>. This can be a source of information about :</p> <ul> <li><strong>Last executed programs</strong></li> <li><strong>Focus Time of the application</strong></li> </ul> <p>The Windows 10 Timeline can be found at the location :</p> <pre><code class="language-raw">C:\Users\&lt;username&gt;\AppData\Local\ConnectedDevicesPlatform\{randomfolder}\ActivitiesCache.db
</code></pre> <p>Because it is a SQLite database, it is possible to visualize it with any SQLite tool viewer. Moreover, Eric Zimmerman’s <em>WxTCmd.exe</em> can help us parse the database into <em>csv</em>.</p> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">user</span><span class="err">@</span><span class="nx">machine</span><span class="err">$</span><span class="w"> </span><span class="nx">WxTCmd.exe</span><span class="w">

</span><span class="n">WxTCmd</span><span class="w"> </span><span class="nx">version</span><span class="w"> </span><span class="nx">0.6.0.0</span><span class="w">

</span><span class="n">Author:</span><span class="w"> </span><span class="nx">Eric</span><span class="w"> </span><span class="nx">Zimmerman</span><span class="w"> </span><span class="p">(</span><span class="n">saericzimmerman</span><span class="err">@</span><span class="nx">gmail.com</span><span class="p">)</span><span class="w">
</span><span class="n">https://github.com/EricZimmerman/WxTCmd</span><span class="w">

        </span><span class="n">f</span><span class="w">               </span><span class="nx">File</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">process.</span><span class="w"> </span><span class="nx">Required</span><span class="w">
        </span><span class="n">csv</span><span class="w">             </span><span class="nx">Directory</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">save</span><span class="w"> </span><span class="nx">CSV</span><span class="w"> </span><span class="nx">formatted</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="nx">to.</span><span class="w"> </span><span class="nx">Be</span><span class="w"> </span><span class="nx">sure</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">include</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">full</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="nx">double</span><span class="w"> </span><span class="nx">quotes</span><span class="w">
        </span><span class="n">dt</span><span class="w">              </span><span class="nx">The</span><span class="w"> </span><span class="nx">custom</span><span class="w"> </span><span class="nx">date/time</span><span class="w"> </span><span class="nx">format</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">use</span><span class="w"> </span><span class="nx">when</span><span class="w"> </span><span class="nx">displaying</span><span class="w"> </span><span class="nx">timestamps.</span><span class="w"> </span><span class="nx">See</span><span class="w"> </span><span class="nx">https://goo.gl/CNVq0k</span><span class="w"> </span><span class="nx">for</span><span class="w"> </span><span class="nx">options.</span><span class="w"> </span><span class="nx">Default</span><span class="w"> </span><span class="nx">is:</span><span class="w"> </span><span class="nx">yyyy-MM-dd</span><span class="w"> </span><span class="nx">HH:mm:ss</span><span class="w">

</span><span class="n">Examples:</span><span class="w"> </span><span class="nx">WxTCmd.exe</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">path-to-timeline-file</span><span class="err">&gt;</span><span class="w"> </span><span class="nt">--csv</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">path-to-save-csv</span><span class="err">&gt;</span><span class="w">
</span></code></pre></div></div> <h3 id="windows-jump-lists">Windows Jump Lists</h3> <p>Windows introduced jump lists to help users go directly to their <strong>recently used per-application files</strong> from the taskbar. Jump lists can be viewed by right-clicking on any taskbar’s application. Also, the data is stored in the following directory :</p> <pre><code class="language-raw">C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations
</code></pre> <p>Jump lists include information about :</p> <ul> <li><strong>Executed applications</strong></li> <li><strong>First time of execution</strong></li> <li><strong>Last time of execution</strong></li> </ul> <p>Eric Zimmerman’s <em>JLECmd.exe</em> helps us parsing Jump Lists :</p> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">user</span><span class="err">@</span><span class="nx">machine</span><span class="err">$</span><span class="w"> </span><span class="nx">JLECmd.exe</span><span class="w">

</span><span class="n">JLECmd</span><span class="w"> </span><span class="nx">version</span><span class="w"> </span><span class="nx">1.4.0.0</span><span class="w">

</span><span class="n">Author:</span><span class="w"> </span><span class="nx">Eric</span><span class="w"> </span><span class="nx">Zimmerman</span><span class="w"> </span><span class="p">(</span><span class="n">saericzimmerman</span><span class="err">@</span><span class="nx">gmail.com</span><span class="p">)</span><span class="w">
</span><span class="n">https://github.com/EricZimmerman/JLECmd</span><span class="w">

        </span><span class="n">d</span><span class="w">               </span><span class="nx">Directory</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">recursively</span><span class="w"> </span><span class="nx">process.</span><span class="w"> </span><span class="nx">Either</span><span class="w"> </span><span class="nx">this</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">required</span><span class="w">
        </span><span class="n">f</span><span class="w">               </span><span class="nx">File</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">process.</span><span class="w"> </span><span class="nx">Either</span><span class="w"> </span><span class="nx">this</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nt">-d</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">required</span><span class="w">
        </span><span class="n">q</span><span class="w">               </span><span class="nx">Only</span><span class="w"> </span><span class="nx">show</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">filename</span><span class="w"> </span><span class="nx">being</span><span class="w"> </span><span class="nx">processed</span><span class="w"> </span><span class="nx">vs</span><span class="w"> </span><span class="nx">all</span><span class="w"> </span><span class="nx">output.</span><span class="w"> </span><span class="nx">Useful</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">speed</span><span class="w"> </span><span class="nx">up</span><span class="w"> </span><span class="nx">exporting</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">json</span><span class="w"> </span><span class="nx">and/or</span><span class="w"> </span><span class="nx">csv.</span><span class="w"> </span><span class="nx">Default</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">FALSE</span><span class="w">

        </span><span class="n">all</span><span class="w">             </span><span class="nx">Process</span><span class="w"> </span><span class="nx">all</span><span class="w"> </span><span class="nx">files</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="nx">directory</span><span class="w"> </span><span class="nx">vs.</span><span class="w"> </span><span class="nx">only</span><span class="w"> </span><span class="nx">files</span><span class="w"> </span><span class="nx">matching</span><span class="w"> </span><span class="o">*.</span><span class="nf">automaticDestinations-ms</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="o">*.</span><span class="nf">customDestinations-ms</span><span class="o">.</span><span class="w"> </span><span class="nx">Default</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">FALSE</span><span class="w">

        </span><span class="n">csv</span><span class="w">             </span><span class="nx">Directory</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">save</span><span class="w"> </span><span class="nx">CSV</span><span class="w"> </span><span class="nx">formatted</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="nx">to.</span><span class="w"> </span><span class="nx">Be</span><span class="w"> </span><span class="nx">sure</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">include</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">full</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="nx">double</span><span class="w"> </span><span class="nx">quotes</span><span class="w">
        </span><span class="n">csvf</span><span class="w">            </span><span class="nx">File</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">save</span><span class="w"> </span><span class="nx">CSV</span><span class="w"> </span><span class="nx">formatted</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="nx">to.</span><span class="w"> </span><span class="nx">When</span><span class="w"> </span><span class="nx">present</span><span class="p">,</span><span class="w"> </span><span class="nx">overrides</span><span class="w"> </span><span class="nx">default</span><span class="w"> </span><span class="nx">name</span><span class="w">
</span><span class="o">...</span><span class="w">

</span><span class="n">Examples:</span><span class="w"> </span><span class="nx">JLECmd.exe</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">path-to-Jumplist-file</span><span class="err">&gt;</span><span class="w"> </span><span class="nt">--csv</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">path-to-save-csv</span><span class="err">&gt;</span><span class="w">
          </span><span class="n">JLECmd.exe</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="s2">"C:\Temp\f01b4d95cf55d32a.customDestinations-ms"</span><span class="w"> </span><span class="nt">--mp</span><span class="w">
          </span><span class="n">JLECmd.exe</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="s2">"C:\Temp\f01b4d95cf55d32a.automaticDestinations-ms"</span><span class="w"> </span><span class="nt">--json</span><span class="w"> </span><span class="s2">"D:\jsonOutput"</span><span class="w"> </span><span class="nt">--jsonpretty</span><span class="w">
          </span><span class="n">JLECmd.exe</span><span class="w"> </span><span class="nt">-d</span><span class="w"> </span><span class="s2">"C:\CustomDestinations"</span><span class="w"> </span><span class="nt">--csv</span><span class="w"> </span><span class="s2">"c:\temp"</span><span class="w"> </span><span class="nt">--html</span><span class="w"> </span><span class="s2">"c:\temp"</span><span class="w"> </span><span class="nt">-q</span><span class="w">
          </span><span class="n">JLECmd.exe</span><span class="w"> </span><span class="nt">-d</span><span class="w"> </span><span class="s2">"C:\Users\e\AppData\Roaming\Microsoft\Windows\Recent"</span><span class="w"> </span><span class="nt">--dt</span><span class="w"> </span><span class="s2">"ddd yyyy MM dd HH:mm:ss.fff"</span><span class="w">
</span></code></pre></div></div> <p>In the lab given within this room, we will investigate the <code class="language-plaintext highlighter-rouge">triage</code> folder to answer the following questions.</p> <h3 id="questions-3">Questions</h3> <p><strong>How many times was <em>gkape.exe</em> executed?</strong></p> <p>After parsing the prefetch file<code class="language-plaintext highlighter-rouge">'C:\Users\THM-4n6\Desktop\triage\C\Windows\prefetch\GKAPE.EXE-E935EF56.pf</code> associated with <em>gkape</em>’s execution history using <em>PECmd</em>.<br> Then, we get the following view of the csv output using <em>EZviewer</em> :</p> <figure> <picture> <img src="/assets/img/images/2025-01-19-thm-windows-forensics-2/Hk7WcT7_Jl.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="GKAPE prefetch parsed in EZviewer" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>The answer is in the <em>RunCount</em> column.</p> <p><em>Answer : <code class="language-plaintext highlighter-rouge">2</code></em></p> <p><strong>What is the last execution time of gkape.exe</strong></p> <p>The answer is in the <em>LastRun</em> column.</p> <p><em>Answer : <code class="language-plaintext highlighter-rouge">12/01/2021 13:04</code></em></p> <p><strong>When <em>Notepad.exe</em> was opened on <em>11/30/2021</em> at <em>10:56</em>, how long did it remain in focus?</strong></p> <p>To get an application’s focus time, we need to go through the <em>Windows 10 Timeline</em> using <em>WxTCmd.exe</em>. Hence, we parse the <em>THM-4n6</em>’s timeline located at <code class="language-plaintext highlighter-rouge">C:\Users\THM-4n6\Desktop\triage\C\Users\THM-4n6\AppData\Local\ConnectedDevicesPlatform\L.THM-4n6\ActivitiesCache.db</code>.</p> <p>Then, we get the following result :</p> <figure> <picture> <img src="/assets/img/images/2025-01-19-thm-windows-forensics-2/S1Nk1RXOye.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="WxTimeline parsed in EZviewer" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p><em>Answer : <code class="language-plaintext highlighter-rouge">00:00:41</code></em></p> <p><strong>What program was used to open <code class="language-plaintext highlighter-rouge">C:\Users\THM-4n6\Desktop\KAPE\KAPE\ChangeLog.txt</code>?</strong></p> <p>In order to get which program was used to open a specific file, we will use the information in <em>Windows Jump Lists</em> files using <em>JLECmd.exe</em>. For this, we will parse the entire directory located at <code class="language-plaintext highlighter-rouge">C:\Users\THM-4n6\Desktop\triage\C\Users\THM-4n6\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations</code> because file names are composed with the AppId of the program and not the program’s name.</p> <figure> <picture> <img src="/assets/img/images/2025-01-19-thm-windows-forensics-2/SyJB-C7d1x.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Jump Lists folder" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Then, we parse them using the <code class="language-plaintext highlighter-rouge">-d</code> parameter and we get this output :</p> <figure> <picture> <img src="/assets/img/images/2025-01-19-thm-windows-forensics-2/BkP-G07_Jg.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="JLE parsed in EZviewer" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p><em>Answer : <code class="language-plaintext highlighter-rouge">notepad.exe</code></em></p> <h2 id="task-6---filefolder-knowledge">Task 6 - File/folder knowledge</h2> <h3 id="shortcut-files">Shortcut Files</h3> <p>Each time a <strong>folder or a file is opened</strong>, etiher locally or remotely, a <strong>shortcut is created</strong>. These contains information about :</p> <ul> <li><strong>First (creation) and last (access) opened times</strong></li> <li><strong>Path of the file</strong></li> <li><strong>Other shortcut metadata (file extention, size, attributes…)</strong></li> </ul> <p>Eric Zimmerman’s <em>Lnk Explorer</em> (LECmd.exe) will help us parse shortcut files.</p> <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">user</span><span class="err">@</span><span class="nx">machine</span><span class="err">$</span><span class="w"> </span><span class="nx">LECmd.exe</span><span class="w">

</span><span class="n">LECmd</span><span class="w"> </span><span class="nx">version</span><span class="w"> </span><span class="nx">1.4.0.0</span><span class="w">

</span><span class="n">Author:</span><span class="w"> </span><span class="nx">Eric</span><span class="w"> </span><span class="nx">Zimmerman</span><span class="w"> </span><span class="p">(</span><span class="n">saericzimmerman</span><span class="err">@</span><span class="nx">gmail.com</span><span class="p">)</span><span class="w">
</span><span class="n">https://github.com/EricZimmerman/LECmd</span><span class="w">

        </span><span class="n">d</span><span class="w">               </span><span class="nx">Directory</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">recursively</span><span class="w"> </span><span class="nx">process.</span><span class="w"> </span><span class="nx">Either</span><span class="w"> </span><span class="nx">this</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">required</span><span class="w">
        </span><span class="n">f</span><span class="w">               </span><span class="nx">File</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">process.</span><span class="w"> </span><span class="nx">Either</span><span class="w"> </span><span class="nx">this</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nt">-d</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">required</span><span class="w">
        </span><span class="n">q</span><span class="w">               </span><span class="nx">Only</span><span class="w"> </span><span class="nx">show</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">filename</span><span class="w"> </span><span class="nx">being</span><span class="w"> </span><span class="nx">processed</span><span class="w"> </span><span class="nx">vs</span><span class="w"> </span><span class="nx">all</span><span class="w"> </span><span class="nx">output.</span><span class="w"> </span><span class="nx">Useful</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">speed</span><span class="w"> </span><span class="nx">up</span><span class="w"> </span><span class="nx">exporting</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">json</span><span class="w"> </span><span class="nx">and/or</span><span class="w"> </span><span class="nx">csv.</span><span class="w"> </span><span class="nx">Default</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">FALSE</span><span class="w">

        </span><span class="n">r</span><span class="w">               </span><span class="nx">Only</span><span class="w"> </span><span class="nx">process</span><span class="w"> </span><span class="nx">lnk</span><span class="w"> </span><span class="nx">files</span><span class="w"> </span><span class="nx">pointing</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">removable</span><span class="w"> </span><span class="nx">drives.</span><span class="w"> </span><span class="nx">Default</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">FALSE</span><span class="w">
        </span><span class="n">all</span><span class="w">             </span><span class="nx">Process</span><span class="w"> </span><span class="nx">all</span><span class="w"> </span><span class="nx">files</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="nx">directory</span><span class="w"> </span><span class="nx">vs.</span><span class="w"> </span><span class="nx">only</span><span class="w"> </span><span class="nx">files</span><span class="w"> </span><span class="nx">matching</span><span class="w"> </span><span class="o">*.</span><span class="nf">lnk</span><span class="o">.</span><span class="w"> </span><span class="nx">Default</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">FALSE</span><span class="w">

        </span><span class="n">csv</span><span class="w">             </span><span class="nx">Directory</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">save</span><span class="w"> </span><span class="nx">CSV</span><span class="w"> </span><span class="nx">formatted</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="nx">to.</span><span class="w"> </span><span class="nx">Be</span><span class="w"> </span><span class="nx">sure</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">include</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">full</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="nx">double</span><span class="w"> </span><span class="nx">quotes</span><span class="w">
        </span><span class="n">csvf</span><span class="w">            </span><span class="nx">File</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">save</span><span class="w"> </span><span class="nx">CSV</span><span class="w"> </span><span class="nx">formatted</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="nx">to.</span><span class="w"> </span><span class="nx">When</span><span class="w"> </span><span class="nx">present</span><span class="p">,</span><span class="w"> </span><span class="nx">overrides</span><span class="w"> </span><span class="nx">default</span><span class="w"> </span><span class="nx">name</span><span class="w">
</span><span class="o">...</span><span class="w">

</span><span class="n">Examples:</span><span class="w"> </span><span class="nx">LECmd.exe</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">path-to-shortcut-files</span><span class="err">&gt;</span><span class="w"> </span><span class="nt">--csv</span><span class="w"> </span><span class="err">&lt;</span><span class="nx">path-to-save-csv</span><span class="err">&gt;</span><span class="w">
          </span><span class="n">LECmd.exe</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="s2">"C:\Temp\foobar.lnk"</span><span class="w">
          </span><span class="n">LECmd.exe</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="s2">"C:\Temp\somelink.lnk"</span><span class="w"> </span><span class="nt">--json</span><span class="w"> </span><span class="s2">"D:\jsonOutput"</span><span class="w"> </span><span class="nt">--jsonpretty</span><span class="w">
          </span><span class="n">LECmd.exe</span><span class="w"> </span><span class="nt">-d</span><span class="w"> </span><span class="s2">"C:\Temp"</span><span class="w"> </span><span class="nt">--csv</span><span class="w"> </span><span class="s2">"c:\temp"</span><span class="w"> </span><span class="nt">--html</span><span class="w"> </span><span class="nx">c:\temp</span><span class="w"> </span><span class="nt">--xml</span><span class="w"> </span><span class="nx">c:\temp\xml</span><span class="w"> </span><span class="nt">-q</span><span class="w">
          </span><span class="n">LECmd.exe</span><span class="w"> </span><span class="nt">-f</span><span class="w"> </span><span class="s2">"C:\Temp\some other link.lnk"</span><span class="w"> </span><span class="nt">--nid</span><span class="w"> </span><span class="nt">--neb</span><span class="w">
          </span><span class="n">LECmd.exe</span><span class="w"> </span><span class="nt">-d</span><span class="w"> </span><span class="s2">"C:\Temp"</span><span class="w"> </span><span class="nt">--all</span><span class="w">
</span></code></pre></div></div> <h3 id="ieedge-history">IE/Edge history</h3> <p>An insteresting fact is that <strong>IE/Edge browsing history</strong> also <strong>includes opened files in the system</strong> as well, whether these files were <strong>opened using the browser or not</strong>. Hence, this makes IE/Edge history a valuable source of information. History cache can be accessed at the <code class="language-plaintext highlighter-rouge">C:\Users\&lt;username&gt;\AppData\Local\Microsoft\Windows\WebCache\WebCacheV*.dat</code> location.</p> <p>In the IE/Edge history, <strong>files/folders appear with the <code class="language-plaintext highlighter-rouge">file:///*</code> prefix</strong>. Despite the fact that several tools can be used to analyze Webcache data, this time we will use <em>Autopsy</em>. To do so, we will select <em>Logical Files</em> as a data source type :</p> <figure> <picture> <img src="/assets/img/images/2025-01-19-thm-windows-forensics-2/rkQUdRQ_ye.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Autopsy Data Source Type selection" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Furthermore, we select our data source location, which is the <code class="language-plaintext highlighter-rouge">triage</code> folder.</p> <figure> <picture> <img src="/assets/img/images/2025-01-19-thm-windows-forensics-2/Byb6OCmukx.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Autopsy Data Source Location selection" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>When autopsy asks about ingest modules, we will only use the <em>Recent Activity</em> one.</p> <figure> <picture> <img src="/assets/img/images/2025-01-19-thm-windows-forensics-2/HJ2GF0Qdkl.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Autopsy Ingest Modules selection" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Finally, we are able to view local files in the <em>URL</em> column through the <em>Web history</em> option in the left panel :</p> <figure> <picture> <img src="/assets/img/images/2025-01-19-thm-windows-forensics-2/HkfScAQOkg.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Autopsy Web History view" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <h3 id="jump-lists">Jump Lists</h3> <p>As we already learned in the previous tasks, <em>Jump Lists</em> create a list of <strong>last opened files per program</strong>. This helps us identify :</p> <ul> <li><strong>Last executed programs</strong></li> <li><strong>Last opened files</strong></li> </ul> <p>As a remember, these are present in the following location :</p> <pre><code class="language-raw">C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations
</code></pre> <h3 id="questions-4">Questions</h3> <p><strong>When was the folder <code class="language-plaintext highlighter-rouge">C:\Users\THM-4n6\Desktop\regripper</code> last opened?</strong></p> <p>Using jump lists and the parsed data made in the previous task, we can look when the <em>regripper</em> folder was last opened in the <em>LastModified</em> column.</p> <figure> <picture> <img src="/assets/img/images/2025-01-19-thm-windows-forensics-2/ByR-rJ4uke.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="JLE regripper last opened" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p><em>Asnwer : <code class="language-plaintext highlighter-rouge">12/1/2021 13:01</code></em></p> <p><strong>When was the above-mentioned folder first opened?</strong></p> <p>On the other hand, we can look when was the <code class="language-plaintext highlighter-rouge">regripper folder</code> first opened by looking at the <em>CreationTime</em> column.</p> <p><em>Answer : <code class="language-plaintext highlighter-rouge">12/1/2021 12:31</code></em></p> <h2 id="task-7---external-devicesusb-device-forensics">Task 7 - External Devices/USB device forensics</h2> <h3 id="setupapi-logs-for-usb-devices">Setupapi logs for USB devices</h3> <p>When any new device is attached to the system, information related to the setup of that device in stored in <code class="language-plaintext highlighter-rouge">C:\Windows\inf\setupapi.dev.log</code>. This logfile contains :</p> <ul> <li><strong>Device serial number</strong></li> <li><strong>First/Last times when the device was connected</strong></li> </ul> <p>To illustrate, here is an example below where when a USB Flash drive is connected and disconnected :</p> <ul> <li>When a USB storage device is plugged in, the system records its serial number along with the date and time of the connection.</li> </ul> <figure> <picture> <img src="/assets/img/images/2025-01-19-thm-windows-forensics-2/BJlZjy4Oyx.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Installing a flash drive" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <ul> <li>When the device is unplugged, the system logs the date and time of its disconnection.</li> </ul> <figure> <picture> <img src="/assets/img/images/2025-01-19-thm-windows-forensics-2/HJAKF14uJl.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Removing a flash drive" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <h3 id="shortcut-files-1">Shortcut files</h3> <p>As we previously learned, shortcut files are automatically created by Windows when a file/folder is opened. This also applies for files in connected USB devices and shortcuts can provide us the following information in this case :</p> <ul> <li><strong>Volume Name</strong></li> <li><strong>Volume Type</strong></li> <li><strong>Volume Serial Number</strong></li> </ul> <p>For recall, this information can be found at :</p> <pre><code class="language-raw">C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Windows\Recent\
C:\Users\&lt;username&gt;\AppData\Roaming\Microsoft\Office\Recent\
</code></pre> <h3 id="question">Question</h3> <p><strong>Which artifact will tell us the first and last connection times of a removable drive?</strong></p> <p><em>Answer : <code class="language-plaintext highlighter-rouge">setupapi.dev.log</code></em></p> <h2 id="task-8---conclusion">Task 8 - Conclusion</h2> <p>To conclude with, in this activity we expanded our knowledge of <strong>Windows forensics</strong> by diving into <strong>advanced artifact analysis</strong> and <strong>practical techniques</strong>. We briefly explored the structure and limitations of <strong>FAT file systems</strong>, touching on how they organize data using clusters and directories. While understanding FAT was foundational, we shifted focus to more advanced systems, like <strong>NTFS</strong>, which introduced features like <strong>journaling</strong>, <strong>access controls</strong>, and <strong>shadow copies</strong>. <strong>NTFS’s Master File Table (MFT)</strong> became a key topic, and tools like <strong>Eric Zimmerman’s MFTECmd</strong> were used to parse and analyze <strong>file metadata for forensic insights</strong>.</p> <p>A major focus was <strong>recovering deleted files</strong> using tools like <strong>Autopsy</strong>. By working with <strong>disk images</strong>, we learned how data could often be restored unless overwritten. This exercise highlighted the importance of <strong>forensically sound methods</strong> to preserve and analyze evidence. Beyond deleted files, we examined artifacts indicating <strong>program execution</strong>, such as <strong>Prefetch files</strong>, <strong>Windows 10 Timeline databases</strong>, and <strong>Jump Lists</strong>. Using tools like <strong>PECmd</strong> and <strong>WxTCmd</strong>, we reconstructed <strong>user activity</strong>, including <strong>program usage</strong> and <strong>accessed files</strong>.</p> <p>We also studied <strong>user interactions</strong> with files and folders by analyzing <strong>shortcut files</strong>, <strong>browsing history</strong>, and <strong>Jump Lists</strong>. These artifacts revealed <strong>patterns of file access and modification</strong>, adding context to investigations. Additionally, <strong>USB forensics</strong> became a critical focus, with <strong>SetupAPI logs</strong> and <strong>registry entries</strong> providing a timeline of <strong>device connections and usage</strong>. These insights are <strong>invaluable for tracking external device activity</strong>.</p> <p>Overall, this activity taught us how to <strong>recover data, analyze user behavior, and trace device interactions</strong>, greatly improving our proficiency in conducting comprehensive forensic investigations.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/THM-Windows-Forensics-1/">THM Windows Forensics 1</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/THM-MalDoc-Static-Analysis/">THM MalDoc: Static Analysis</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/THM-Advanced-Static-Analysis/">THM Advanced Static Analysis</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/THM-Basic-Dynamic-Analysis/">THM Basic Dynamic Analysis</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/THM-Anti-Reverse-Engineering/">THM Anti-Reverse Engineering</a> </li> </div> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 NonoHM . Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?da39b660470d1ba6e6b8bf5f37070b6e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>