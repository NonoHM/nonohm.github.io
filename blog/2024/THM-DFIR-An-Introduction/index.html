<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> THM DFIR: An Introduction | NonoHM </title> <meta name="author" content="NonoHM "> <meta name="description" content="Welcome to my personnal website. I am currently a 2nd year student in the " but r et t program. i like doing sports and music besides learning new things in it.> <meta name="keywords" content="jekyll, jekyll-theme, portfolio-website, writeups, projects"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link defer href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://nonohm.github.io/blog/2024/THM-DFIR-An-Introduction/"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?0afe9f0ae161375728f7bcc5eb5b4ab4"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> NonoHM </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">THM DFIR: An Introduction</h1> <p class="post-meta"> November 21, 2024 • NonoHM </p> <p class="post-tags"> <a href="/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/thm"> <i class="fa-solid fa-hashtag fa-sm"></i> THM</a>   <a href="/blog/tag/digital-forensics"> <i class="fa-solid fa-hashtag fa-sm"></i> Digital Forensics</a>   <a href="/blog/tag/incident-response"> <i class="fa-solid fa-hashtag fa-sm"></i> Incident Response</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <h2 id="task-1---introduction">Task 1 - Introduction</h2> <p>Firstly, security breaches and incidents happen despite the security teams trying their best to avoid them. The prudent approach is to prepare for the time an accident could happen so we are not caught off-guard. Consequently, when an incident happens, it is essential to identify footprints left by an attacker, in order to determine the scope of compromise in an environment, and restore it to the state it was before the incident occured. Hence, this is where Digital Forensics and Incident Response (DFIR) comes to place.</p> <p>In this room, we will cover the following topics:</p> <ul> <li>Introduction fo DFIR</li> <li>Some basic concepts used in the DFIR field</li> <li>The Incident Response processes used in the industry</li> <li>Some of the tools used for DFIR</li> </ul> <h2 id="task-2---the-need-for-dfir">Task 2 - The need for DFIR</h2> <blockquote> <p><strong>Definitions</strong><br> <strong>Forensics :</strong> Application of scientific methods and techniques to investigate crimes and present evidence in court. It involves analyzing both physical, digital or biological evidence to uncover facts and support legal proceedings.<br> <strong>Incident :</strong> An unexpected event which can disrupt the general operation but does not necessarily lead to serious damages or major consequences.<br> <strong>Accident :</strong> A sudden, unforeseen event that results in damage, injury or loss of life or property.</p> </blockquote> <h3 id="what-is-dfir">What is DFIR</h3> <p>As already mentioned, DFIR stands for <strong>Digital Forensics and Incident Response</strong>. This field covers the <strong>collection of forensic artifacts from digital devices</strong> such as computers, media devices and smartphones to <strong>investigate an incident</strong>. This field helps Security Professionals identify footprints left by an attacker when a security incident occurs, use them to <strong>determine the extent of compromise</strong> in a environment and <strong>restore the environment</strong> to the state it was before the incident occured.</p> <h3 id="the-need-for-dfir">The need for DFIR</h3> <p>DFIR helps security professionals in various ways, some of which are summarized below:</p> <ul> <li> <strong>Finding evidence of attacker activity</strong> in the network and sifting false alarms from actual incidents.</li> <li> <strong>Robustly removing the attacker</strong> to erase its foothold from the network.</li> <li> <strong>Identifying the extent and timeframe of a breach</strong>. This helps in communicating with relevant stakeholders.</li> <li> <strong>Finding the loopholes</strong> that led to the breach. What needs to be changed to avoid another on in the future ?</li> <li> <strong>Understanding attacker behavior</strong> to pre-emptively block further intrusion attempts by the attacker.</li> <li> <strong>Sharing information about the attacker</strong> with the community.</li> </ul> <h3 id="who-performs-dfir-">Who performs DFIR ?</h3> <p>As the name suggests, DFIR require expertise in both Digital Forensics and Incident Response. Dividing these two fields this way, the following skillset is needed to become a DFIR profesisonal :</p> <ul> <li> <strong>Digital Forensics :</strong> These profesionnals are experts in identifying forensic artifacts or evidence of human activity in digital devices.</li> <li> <strong>Incident Response :</strong> Incident responders are experts in cybersecurity and leverage forensic information to identify the activity of interest from a security perspective.</li> </ul> <p>DFIR professionals combine these domains to achieve their goals. Digital Forensics and Incident Response domains are often combined because they are highly interdependent. Incident Response leverages knowledge gained from Digital Forensics and Digital Forensics takes its goals and scope from the Incident Response process.</p> <h3 id="questions">Questions</h3> <p><strong>What does DFIR stand for?</strong></p> <p><em>Answer: <code class="language-plaintext highlighter-rouge">Digital forensics and Incident Response</code></em></p> <p><strong>DFIR requires expertise in two fields. One of the fields is Digital Forensics. What is the other field?</strong></p> <p><em>Answer: <code class="language-plaintext highlighter-rouge">Incident Response</code></em></p> <h2 id="task-3---basic-concepts-of-dfir">Task 3 - Basic concepts of DFIR</h2> <h3 id="artifacts">Artifacts</h3> <p>Artifacts are <strong>pieces of evidence that point to an activity performed on a system</strong>. When performing DFIR, they are collected to <strong>support a hypothesis or to claim about attacker activity</strong>. For example, a Windows <em>Registry key</em> used to maintain persistence on a system is considered as an artifact.<br> Artifact collection is, therefore, an essential part of the DFIR process. Artifacts can be collected from Endpoint or Server file systems, memory r network activity.</p> <p>In most corporate environments, Windows systems are mainly used for endpoints/servers such as <em>Active Directory domain controllers</em> or <em>MS Exchange mail servers</em>. On the other hand, Linux systems are mainly used for hosting services such as <em>web servers</em> or <em>databases</em>.</p> <h3 id="evidence-preservation">Evidence Preservation</h3> <p>Maintaining the <strong>integrity of evidences is a must</strong> when performing DFIR. For this reason, certain best practices are established in the industry. We must note that <strong>any forensic analysis contaminates</strong> the evidence.<br> For example, the evidence is first collected and <strong>write-protected</strong>. This copy is used for analysis, ensuring our original evidence is not contaminated and remains safe while analyzing. If the copy gets corrupted, we can always return and make a new copy from the preserved evidence.</p> <h3 id="chain-of-custody">Chain of custody</h3> <p>Afterward, when the evidence is collected, it must be made sure that it is kept in secure custody. Any person related to the investigation must not possess the evidence or it will <strong>contaminate the chain of custody</strong> (CoC) of the evidence. A contaminated CoC raises questions about the data integrity, hence <strong>weakens the case</strong> being built by adding unknown variables that can’t be solved.<br> For example, an hard drive image that has been handled by an unqualified third party weakens the evidence because we can not be sure it has been dealt correctly or contaminated.</p> <h3 id="order-of-volatility">Order of volatility</h3> <p>Digital evidence if <strong>often volatile</strong> and can be lost forever if not captured in time. Some sources are more volatile than others, i.e <strong>RAM is more volatile than an SSD</strong> since the RAM keeps data only as long as it remains powered on. Hence it is vital to understand the order of volatility of the different sources to <strong>capture and preserve accordingly</strong>. Thus, we might preserve the RAM before preserving hard drives because of its nature.</p> <h3 id="timeline-creation">Timeline creation</h3> <p>Once artifacts are collected and their integrity is preserved, we need to <strong>present them understandably</strong> to <strong>fully use the contained information</strong>. A timelime of events needs to be created in order to <strong>put all the activities in chronological order</strong>. This activity is called <em>Timeline Creation</em>. It provides perspective to the investigation and helps collate information from various sources to <strong>create a story of how things happened</strong>.</p> <h3 id="questions-1">Questions</h3> <p><strong>From amongst the RAM and the hard disk, which storage is more volatile?</strong></p> <p><em>Answer : <code class="language-plaintext highlighter-rouge">RAM</code></em></p> <p><strong>Complete the timeline creation exercise in the attached static site. What is the flag that you get after completion?</strong></p> <p><em>Answer: <code class="language-plaintext highlighter-rouge">THM{DFIR_REPORT_DONE}</code></em></p> <h2 id="task-4---dfir-tools">Task 4 - DFIR Tools</h2> <h3 id="eric-zimmermans-tools">Eric Zimmerman’s tools</h3> <p>Eric Zimmerman is a secuiry researcher who has written a few tools to help perform <strong>forensic analysis on the Windows Platform</strong>. These tools can be use in the <a href="https://tryhackme.com/room/windowsforensics1" rel="external nofollow noopener" target="_blank">Windows Forensics 1</a> and <a href="https://tryhackme.com/room/windowsforensics2" rel="external nofollow noopener" target="_blank">Windows Forensics 2</a> rooms.</p> <h3 id="kape">KAPE</h3> <p><em>Kroll Artifact Parser and Extractor</em> is another beneficial tool by Eric Zimmerman. It automates the <strong>collection and parsing of forensic artifacts</strong>, which can help <strong>create a timeline of events</strong>. This tool is shown of in the <a href="https://tryhackme.com/room/kape" rel="external nofollow noopener" target="_blank">KAPE room</a>.</p> <h3 id="autopsy">Autopsy</h3> <p><em>Autopsy</em> is an open-source forensics platform that helps <strong>analyze data from digital media</strong> like mobile devices, hard drives, removable drives… Various plugins speed up the forensic process by <strong>extracting and presenting valuable information from raw data sources</strong>. This tool is shown off in the <a href="https://tryhackme.com/room/btautopsye0" rel="external nofollow noopener" target="_blank">Autopsy room</a>.</p> <h3 id="volatility">Volatility</h3> <p><em>Volatility</em> is a tool that helps perform <strong>memory analysis for memory captures</strong> from both Windows and Linux OSes. It is a powerful tool that can help extract valuable information from the memory of a machine under investigation. This tool is shown off in the <a href="https://tryhackme.com/room/volatility" rel="external nofollow noopener" target="_blank">Volatility room</a>.</p> <h3 id="redline">Redline</h3> <p><em>Redline</em> is an incident response tool developed and freely distributed by FireEye. This tool can <strong>gather forensic data from a system</strong> and help with collected forensic information. This tool is shown off in the <a href="https://tryhackme.com/room/btredlinejoxr3d" rel="external nofollow noopener" target="_blank">Redline room</a>.</p> <h3 id="velociraptor">Velociraptor</h3> <p><em>Velociraptor</em> is an open-source advanced <strong>endpoint monitoring, forensics and response</strong> platform. This tool is shown off in the <a href="https://tryhackme.com/room/velociraptorhp" rel="external nofollow noopener" target="_blank">Velociraptor room</a>.</p> <h2 id="task-5---the-incident-response-process">Task 5 - The Incident Response process</h2> <p>In <em>Security Operations</em>, the proment use of <em>Digital Forensics</em> is to perform <em>Incident Reponse</em>.</p> <p>Different organizations have published standardized methods to perform Incident Reponse. NIST has defined a process in their <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-61r2.pdf" rel="external nofollow noopener" target="_blank">SP-800-61 Incident Handling guide</a>, which has the following steps:</p> <ol> <li><strong>Preparation</strong></li> <li><strong>Detection and Analysis</strong></li> <li><strong>Containment, Eradication, and Recovery</strong></li> <li><strong>Post-incident Activity</strong></li> </ol> <p>Similarly, SANS has published an <a href="https://www.sans.org/white-papers/33901/" rel="external nofollow noopener" target="_blank">Incident Handler’s handbook</a>. The handbook defines the steps as follows:</p> <ol> <li><strong>Preparation</strong></li> <li><strong>Identification</strong></li> <li><strong>Containment</strong></li> <li><strong>Eradication</strong></li> <li><strong>Recovery</strong></li> <li><strong>Lessons Learned</strong></li> </ol> <p>Steps defined by SANS are often summarized as the <em>PICERL</em> acronym, making them easy to remember. SANS and NIST steps are identical. While NIST combines <em>Containment</em>, <em>Eradication</em> and <em>Recovery</em>, SANS separate them into different steps.</p> <pre><code class="language-raw">+-------------------+     +-------------------+     +-------------------+     +-------------------+     +-------------------+     +-------------------+
|    Preparation    | --&gt; |  Identification   | --&gt; |    Containment    | --&gt; |    Eradication    | --&gt; |      Recovery     | --&gt; |  Lessons Learned  |
+-------------------+     +-------------------+     +-------------------+     +-------------------+     +-------------------+     +-------------------+
</code></pre> <p>Below is the explanation of the SANS <em>Incident Handler’s</em> steps.</p> <ol> <li> <strong>Preparation:</strong> Before an incident happens, preparation needs to be done so that everyone is ready in case of an incident. Preparation includes having the required people, processes, and technology to prevent and respond to incidents.</li> <li> <strong>Identification:</strong> An incident is identified through some indicators in the identification phase. These indicators are then analyzed for False Positives, documented, and communicated to the relevant stakeholders.</li> <li> <strong>Containment:</strong> In this phase, the incident is contained, and efforts are made to limit its effects. There can be short-term and long-term fixes for containing the threat based on forensic analysis of the incident that will be a part of this phase.</li> <li> <strong>Eradication:</strong> Next, the threat is eradicated from the network. It has to be ensured that a proper forensic analysis is performed and the threat is effectively contained before eradication. For example, if the entry point of the threat actor into the network is not plugged, the threat will not be effectively eradicated, and the actor can gain a foothold again.</li> <li> <strong>Recovery:</strong> Once the threat is removed from the network, the services that had been disrupted are brought back as they were before the incident happened.</li> <li> <strong>Lessons Learned:</strong> Finally, a review of the incident is performed, the incident is documented, and steps are taken based on the findings from the incident to make sure that the team is better prepared for the next time an incident occurs.</li> </ol> <h3 id="questions-2">Questions</h3> <p><strong>At what stage of the IR process are disrupted services brought back online as they were before the incident?</strong></p> <p><em>Answer: <code class="language-plaintext highlighter-rouge">Recovery</code></em></p> <p><strong>At what stage of the IR process is the threat evicted from the network after performing the forensic analysis ?</strong></p> <p><em>Answer: <code class="language-plaintext highlighter-rouge">Eradication</code></em></p> <p><strong>What is the NIST-equivalent of the step called “Lessons learned” in the SANS process?</strong></p> <p><em>Answer: <code class="language-plaintext highlighter-rouge">Post-incident Activity</code></em></p> <h2 id="task-6---conclusion">Task 6 - Conclusion</h2> <p>To conclude, in this room we have learned about <strong>Digital Forensics and Incident Response (DFIR)</strong> and its crucial role in the world of cybersecurity. We explored various key concepts and processes that are essential when dealing with security incidents, such as <strong>artifacts</strong>, <strong>evidence preservation</strong>, <strong>chain of custody</strong>, <strong>order of volatility</strong> and <strong>timeline creation</strong>.</p> <p>We also delved into some of the most widely used tools in the industry, including <strong>KAPE</strong>, <strong>Autopsy</strong>, and <strong>Volatility</strong>, and discussed their applications in real-world incident response scenarios.</p> <p>In addition, we covered the <strong>PICERL process</strong>—the standard process for incident response that helps organizations effectively handle and recover from security breaches. The steps include <strong>Preparation</strong>, <strong>Identification</strong>, <strong>Containment</strong>, <strong>Eradication</strong>, <strong>Recovery</strong>, and <strong>Lessons Learned</strong>. Each of these phases is essential for ensuring that security incidents are handled efficiently and with minimal damage.</p> <p>Ultimately, DFIR professionals help organizations <strong>detect</strong>, <strong>respond to</strong>, and <strong>recover from</strong> cyber incidents, and their role continues to grow as cyber threats evolve. By understanding the key concepts, tools, and processes involved in DFIR, we are better equipped to protect and respond to security incidents in the future.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/THM-Windows-Forensics-1/">THM Windows Forensics 1</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/THM-Windows-Forensics-2/">THM Windows Forensics 2</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/THM-Advanced-Static-Analysis/">THM Advanced Static Analysis</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/THM-MalDoc-Static-Analysis/">THM MalDoc: Static Analysis</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2024/THM-Basic-Dynamic-Analysis/">THM Basic Dynamic Analysis</a> </li> </div> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 NonoHM . Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?da39b660470d1ba6e6b8bf5f37070b6e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>